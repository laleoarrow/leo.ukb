% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/genotype.R
\name{ukb_hla_typing}
\alias{ukb_hla_typing}
\title{ukb_hla_typing}
\usage{
ukb_hla_typing(df, header, col = "p22182", q_threshold = 0.7)
}
\arguments{
\item{df}{A data.frame/tibble with \code{eid} and a compound column (default \code{p22182}).}

\item{header}{Allele column order, e.g. \code{ukb_hla_header()$hla_order}.}

\item{col}{Compound column name. Default "p22182".}

\item{q_threshold}{Posterior threshold (UKB commonly uses 0.7). Default 0.7.}
}
\value{
A list with \code{calls} (long table) and \code{genotype} (eid x locus).
}
\description{
Parse UKB HLA v2 compound field (22182) and derive per-locus genotypes.
}
\examples{
\dontrun{
library(tidyverse)
# x <- data.table::fread("HLA.csv")         # eid + p22182
header <- ukb_hla_header()$hla_order
res <- ukb_hla_typing(x, header)
res$genotype \%>\% dplyr::filter(locus == "A") \%>\% dplyr::slice_head(n = 5)
}
}
